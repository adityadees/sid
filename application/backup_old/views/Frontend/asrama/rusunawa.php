<section id="page-title"  class="background-overlay-dark" data-parallax-image="<?= base_url('assets/images/asrama/apartemen.png')?>">
    <div class="container">
        <div class="page-title">
            <h1><?= $title; ?></h1>
        </div>
        <div class="breadcrumb">
            <ul>
                <li><a href="<?= base_url()?>" title="Home">Home</a></li>
                <li><a href="<?= base_url('asrama')?>" title="Asrama">Asrama</a></li>
                <li class="active"><a href="#"><?= $title; ?></a></li>
            </ul>
        </div>
    </div>
</section>

<section class="box-fancy section-fullwidth text-light p-b-0 p-t-0">
    <div class="row">
        <div class="col-lg-4" style="background-color: rgb(241, 183, 50);">
            <div class="row">
                <div class="col-md-12">
                    <h1 class="text-lg text-uppercase">01.</h1>
                    <h3>Select Type</h3>
                    <span>
                        Rusunawa UNSRI memiliki 3 buah gedung rusunawa yaitu <span class="badge badge-danger">Rusunawa Putra</span>, <span class="badge badge-danger">Rusunawa Putri</span> dan <span class="badge badge-danger">Rusunawa Baru Putri</span>, setiap gedung rusunawa memiliki tinggi <span class="badge badge-danger">5 Lantai</span>, untuk Rusunawa Baru kamarnya berjumlah 4 sedangkan yang lain terdiri dari 2 kamar.
                        Anda dapat melihat dan menentukan sendiri di gedung dan lantai berapakah anda ingin menyewanya.
                    </span>
                    <br>
                    <br>
                    <h3 class="text-center">Tata Tertib<br>Rusunawa Mahasiswa</h3>
                    <div class="accordion accordion-simple">
                        <div class="ac-item">
                            <h5 class="ac-title">PENGGUNAAN RUANG/KAMAR DAN INVENTARIS</h5>
                            <div class="ac-content">
                                <ul class="list-icon list-icon-arrow list-icon-colored">
                                    <li>Penghuni  asrama/rusunawa/apartemen mahasiswa wajib menjaga dan memelihara ruang/kamar dan inventarisnya dengan baik;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa dilarang mencoret atau membuat tulisan  pada ruang/kamar  dan inventaris yang disediakan oleh pengelola asrama;</li>
                                    <li>Apabila terjadi kerusakan atau kehilangan barang-barang inventaris asrama/rusunawa/apartemen mahasiswa yang disengaja oleh penghuni menjadi tanggung-jawab penghuni untuk menggantinya;</li>
                                    <li>Penggunaan ruang lobby untuk keperluan lain harus seijin pengelola;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa dilarang membawa/ memelihara hewan peliharaan di dalam lingkungan asrama;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen Mahasiswa dilarang menjemur pakaian diluar tempat yang sudah disediakan;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa dilarang memberikan kepada orang lain untuk tinggal di dalam kamar yang bersangkutan dengan alasan apapun;</li> 
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa tidak diperbolehkan memasak di lobby maupun dalam kamar;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa dilarang merokok atau minum minuman keras atau menggunakan narkoba baik didalam atau di Lingkungan asrama/rusunawa/apartemen mahasiswa.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="ac-item">
                            <h5 class="ac-title">LINGKUNGAN ASRAMA, RUSUNAWA, APARTEMEN MAHASISWA</h5>
                            <div class="ac-content">
                                <ul class="list-icon list-icon-arrow list-icon-colored">
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa dilarang berdua dengan lawan jenis yang bukan muhrimnya dalam lingkungan Universitas Sriwijaya;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa menjaga etika dan moral selama berada di Lingkungan Universitas Sriwijaya;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa berpakaian sopan selama berada di Lingkungan Universitas Sriwijaya;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa hanya boleh menerima tamu di ruang lobby pada jam 07.00 s/d 21.00 WIB;</li>
                                    <li>Penghuni tidak diperbolehkan menerima tamu di dalam kamar;</li>
                                    <li>Penghuni putri dilarang masuk ke blok penghuni putra demikian juga sebaliknya, Penghuni putra dilarang masuk ke blok  penghuni putri;</li>
                                    <li>Tamu keluarga atau teman penghuni dilarang menginap di kamar penghuni, untuk tamu keluarga yang akan menginap disediakan penginapan dan di kenakan biaya;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa  wajib mematikan kran air, listrik dalam kamar sebelum pergi meninggalkan ruangan;</li>
                                    <li>Kegiatan apapun yang menggunakan sarana asrama/rusunawa/apartemen mahasiswa wajib lapor dengan petugas kepala Asrama;</li>
                                    <li>Penghuni wajib berada di asrama/rusunawa/apartemen pada pukul 21.00 WIB dan jika ada kepentingan lain harus memberikan penjelasan kepada petugas / keamanan asrama/rusunawa/apartemen mahasiswa;</li>
                                    <li>Menjaga ketertiban dan kenyamanan lingkungan asrama/rusunawa/apartemen mahasiswa;</li>
                                    <li>Menjaga dan memelihara kebersihan lingkungan  asrama/rusunawa/apartemen mahasiswa;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa  wajib menitipkan kunci kepada kepala asrama pada waktu libur, atau meninggalkan tempat lebih dari satu hari.</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa  tidak boleh menggandakan kunci;</li>
                                    <li>Apabila terbukti melanggar akan dikeluarkan dari asrama/rusunawa/apartemen mahasiswa dan  akan diproses secara hukum sesuai peraturan yang berlaku;</li>
                                </ul>
                            </div>
                        </div>
                        <div class="ac-item">
                            <h5 class="ac-title">KEAMANAN</h5>
                            <div class="ac-content">
                                <ul class="list-icon list-icon-arrow list-icon-colored">
                                    <li>Keamanan barang berharga didalam kamar merupakan tanggung jawab penghuni asrama/rusunawa/apartemen mahasiswa;</li>
                                    <li>Pihak Pengelola asrama/rusunawa/apartemen mahasiswa hanya menyediakan lahan parkir untuk kendaraan roda dua/sepeda motor. Lahan parkir untuk kendaraan roda 4/mobil hanya untuk mengakomodir tamu penginapan;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa wajib parkir kendaraan di tempat yang telah ditentukan;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa diwajibkan untuk menggunakan kunci ganda untuk keamanan kendaraan bermotor yang diparkir;</li>
                                    <li>Pengelola asrama/rusunawa/apartemen tidak bertanggung jawab atas kehilangan barang-barang milik penghuni;</li>
                                    <li>Jam malam yang berlaku di asrama/rusunawa/apartemen mahasiswa jam 21.00 WIB, Apabila penghuni akan atau pulang terlambat harap mengisi buku laporan di Kepala Asrama;</li>
                                    <li>Penghuni asrama/rusunawa/apartemen mahasiswa yang melakukan mabuk, madat, memakai obat bius atau narkotika, melakukan tindakan asusila, berjudi dalam bentuk apapun serta berkelahi, dikenakan sanksi yaitu dikeluarkan secara sepihak oleh pihak pengelola asrama dan  akan diproses secara hukum sesuai peraturan yang berlaku;</li>
                                    <li>Tata tertib ini berlaku untuk semua yang bertempat tinggal di asrama/rusunawa/apartemen mahasiswa Universitas Sriwijaya.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="ac-item">
                            <h5 class="ac-title">SANKSI</h5>
                            <div class="ac-content">
                                <ul class="list-icon list-icon-arrow list-icon-colored">
                                    <li>Sanksi akan diberikan kepada penghuni asrama/rusunawa/apartemen mahasiswa yang melanggar tata tertib di atas.</li>
                                    <li>Sanksi yang diberikan berupa surat teguran, sampai pada sanksi dikeluarkan secara sepihak oleh pihak pengelola asrama dan di kenakan hukuman sesuai peraturan yang berlaku.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="ac-item">
                            <h5 class="ac-title">LAIN – LAIN</h5>
                            <div class="ac-content">
                                <ul class="list-icon list-icon-arrow list-icon-colored">
                                    <li>Hal-hal yang  belum diatur dalam tata tertib asrama/rusunawa/apartemen mahasiswa akan dituangkan dalam ketentuan terpisah.</li>
                                    <li>Tata tertib ini berlaku sejak ditulis sampai dibuatnya tata tertib baru.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="line"></div>



                    <form>
                        <fieldset class="form-group">
                            <div class="row">
                                <legend class="col-form-label col-sm-2 pt-0">Gedung Rusunawa</legend>
                                <div class="col-sm-10">

                                    <div class="form-check">
                                        <label class="p-radio">
                                            <input type="radio" name="gdgtype" value="BA" checked>
                                            <span class="p-radio-style"></span>
                                            <span>&nbsp;Rusunawa Putra</span>
                                        </label>
                                    </div>


                                    <div class="form-check">
                                        <label class="p-radio">
                                            <input type="radio" name="gdgtype" value="BB">
                                            <span class="p-radio-style"></span>
                                            <span>&nbsp;Rusunawa Putri</span>
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <label class="p-radio">
                                            <input type="radio" name="gdgtype" value="BC">
                                            <span class="p-radio-style"></span>
                                            <span>&nbsp;Rusunawa Baru Putri</span>
                                        </label>
                                    </div>

                                </div>
                            </div>
                        </fieldset>


                        <div id="newd">
                        </div>


                        <div class="form-group row">
                            <label for="inputPassword3" class="col-sm-2 col-form-label">Lantai</label>
                            <div class="col-sm-10">
                                <select id="lantaiid" class="form-control">
                                    <option value="1">Lantai 1</option>
                                    <option value="2">Lantai 2</option>
                                    <option value="3">Lantai 3</option>
                                    <option value="4">Lantai 4</option>
                                    <option value="5">Lantai 5</option>
                                </select>

                            </div>
                        </div>
                        <input type="hidden" name="" id="readLantai">
                        <input type="hidden" name="" id="readGedung">



                        <div class="form-group row">
                            <div class="col-sm-12 mx-auto text-center">
                                <button type="button" class="btn" id="btn_update">&nbsp;&nbsp;&nbsp;Cek&nbsp;&nbsp;&nbsp;</button>
                                <button type="button" 
                                data-target="<?php if(!isset($this->data['token_mhs']['username'])) { echo '#modalLogin'; } else { echo '#myModal'; } ?>" 
                                data-toggle="modal" 
                                class="btn btn-default" 
                                id="btn_updates" <?php if(count($regcur)>0){ echo 'disabled title="Untuk saat ini anda tidak dapat melakukan pendaftaran"'; } ?> <?php if(isset($regsuc) && isset($kuota)) {if(count($regsuc)>0 || $kuota <=0){ echo 'disabled title="Untuk saat ini anda tidak dapat melakukan pendaftaran"'; } }?>>Register</button>
                            </div>
                        </div>
                        <?php




                        if (isset($regsuc)) {
                            if(count($regsuc)>0){
                                ?>
                                <div class="form-group row">
                                    <div class="col-sm-12 mx-auto text-left">
                                        <div class="alert alert-danger">
                                            Anda sudah terdaftar sebagai penyewa asrama, anda tidak dapat melakukan registrasi lagi untuk saat ini.
                                        </div>
                                    </div>
                                </div>
                                <?php  
                            } else if(count($regcur)>0){
                                ?>
                                <div class="form-group row">
                                    <div class="col-sm-12 mx-auto text-left">
                                        <div class="alert alert-danger">
                                            Anda sudah melakukan registrasi pada tanggal 
                                            <mark><?= date('d-m-Y',strtotime($regcur[0]->registrasi_tgl)) ?>.</mark> Saat ini permintaan anda belum diverifikasi, silahkan cek email anda untuk melihat persyaratan verifikasi data. Jika sampai tanggal 
                                            <mark> <?= date('d-m-Y',strtotime($regcur[0]->registrasi_tgl_end)) ?></mark> anda tidak melakukan verifikasi, maka anda harus melakukan registrasi ulang.
                                            <hr>
                                            Sisa waktu anda adalah :
                                            <div class="countdown rectangle small" data-countdown="<?= date('Y/m-d',strtotime($regcur[0]->registrasi_tgl_end)) ?> 23:59:59"></div>
                                        </div>
                                    </div>
                                </div>
                                <?php
                            } else if (isset($kuota)) {
                                if($kuota<=0){
                                    ?>
                                    <div class="form-group row">
                                        <div class="col-sm-12 mx-auto text-left">
                                            <div class="alert alert-danger">
                                                Maaf, untuk saat ini anda tidak bisa melakukan registrasi dikarenakan kuota sudah mencapai batas maksimal.<br>
                                            </div>
                                        </div>
                                    </div>
                                    <?php  
                                } 
                            } else{}
                        } 
                        ?>


                    </form> 

                    <h3>Informasi</h3>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="p-progress-bar-container radius small title-up">
                                <div class="p-progress-bar" data-percent="<?= $box['tersedia'];?>" data-delay="100" data-type="%" id="progtersedia">
                                    <div class="progress-title">Kosong</div>
                                </div>
                            </div>
                            <div class="p-progress-bar-container radius small title-up">
                                <div class="p-progress-bar" data-percent="<?= $box['terisi'];?>" data-delay="300" data-type="%" id="progterisi">
                                    <div class="progress-title">Terisi</div>
                                </div>
                            </div>
                            <div class="p-progress-bar-container radius small title-up">
                                <div class="p-progress-bar" data-percent="<?= $box['rusak'];?>" data-delay="400" data-type="%" id="progrusak">
                                    <div class="progress-title">Rusak</div>
                                </div>
                            </div>
                        </div>


                        <!-- <div class="col-md-6">
                            <div class="p-progress-bar-container radius small title-up">
                                <div class="p-progress-bar" data-percent="<?= $box['booking'];?>" data-delay="200" data-type="%" id="progbooking">
                                    <div class="progress-title">Booking</div>
                                </div>
                            </div>

                        </div> -->
                    </div>



                </div>
            </div>
        </div>
        <div class="col-lg-8" style="background-color: rgb(252, 196, 63);">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="text-lg text-uppercase">02.</h2>
                    <h3>Select Room</h3>
                    <span>
                        Gambar dibawah ini merupakan denah lokasi apartemen, untuk melakukan pengajuan permohonan penyewaan apartemen sialahkan arahkan mouse pada kotak kemudian klik maka secara otomatis akan muncul popup yang berisikan aggrement box.
                    </span>

                    <br>
                    <br>
                    
                </div>
            </div>

            <div class="line"></div>

            <div class="portfolio-item-wrap" id="svgfile">
                <object data="<?= base_url('assets/svgrender/'.$svgfile)?>" type="image/svg+xml" id="alphasvg" width="100%" height="100%"></object>
            </div>


        </div>
    </div>
</section>

<?php if(count($regcur)==0 && $kuota > 0){ ?> 
    <div class="modal fade" id="myModal" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <form action="<?= base_url('frontend/asrama/rusunawa/booking_kamar')?>" method="POST" enctype="multipart/form-data">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="modal-label"></h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">

                                <div class="row" id="myDIV">

                                    <div class="col-lg-12">
                                        <div class="card">
                                            <div class="card-body" style="overflow: scroll;overflow-x: hidden;max-height: 300px">
                                                <div class="row">
                                                    <div class="col-md-12">

                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <h4 class="text-center">HAK DAN KEWAJIBAN PENGHUNI</h4>
                                                                <p class="text-justify">
                                                                    Dengan ini saya akan menyetujia dan mematuhi semua perjanjian dan peraturan yang tertulis dalam point dibawah ini :
                                                                </p>
                                                                <p class="text-justify">
                                                                    Kewajiban Penghuni asrama, rusunawa, apartemen mahasiswa :
                                                                </p>
                                                            </div>
                                                        </div>


                                                        <div class="row">
                                                            <div class="col-md-11 mx-auto text-justify">

                                                                <ol type="A">
                                                                    <li><b>Hak penghuni</b>
                                                                        <ol>
                                                                            <li>Tinggal selama waktu satu tahun dan boleh diperpanjang jika memenuhi syarat yang ditentukan oleh pengelola asrama / rusunawa / apartemen mahasiswa;</li>
                                                                            <li>Menggunakan fasilitas asrama/rusunawa / apartemen mahasiswa;</li>
                                                                            <li>Memperoleh layanan yang sama untuk semua penghuni.</li>
                                                                            <li>Memperoleh perlindungan keamanan.</li>
                                                                            <li>Berkreasi, apresiasi sesuai dengan kreatifitas masing-masing.</li>
                                                                            <li>Berpendapat, berorganisasi sesuai dengan minat dan aspirasi masing-masing penghuni.</li>
                                                                            <li>Membina diri sesuai dengan keyakinan beragama masing-masing secara bersama-sama.</li>
                                                                        </ol>
                                                                    </li>
                                                                    <br>
                                                                    <li>
                                                                        <b>Kewajiban Penghuni asrama, rusunawa, apartemen mahasiswa
                                                                        </b>
                                                                        <ol>
                                                                            <li>Membayar iuran apartemen mahasiswa minimal 6 (enam) bulan di awal;</li>
                                                                            <li>Mahasiswa dapat memperpanjang maksimal 6 (enam bulan) berikutnya dengan membayar di awal sesuai  kewajiban 1;</li>
                                                                            <li>Khusus untuk mahasiswa bidik misi membayar iuran asrama atau rusunawa mahasiswa 3 (tiga) bulan di awal;</li>
                                                                            <li>Mahasiswa bidik misi melunasi iuran asrama atau rusunawa mahasiswa setelah dana bidikmisi dibayarkan;</li>
                                                                            <li>Mahasiswa membayar iuran asrama / rusunawa / apartemen ke rekening rektor melalui Bank Sumsel Babel <br>
                                                                                Nomor Rekening   :  1403070528 <br>
                                                                                Pemilik :  an. RPL 014 UNSRI Utk Penampungan Kerja Sama. 
                                                                            </li>
                                                                            <li>Mentaati tata tertib, peraturan dan pedoman kehidupan di asrama / rusunawa / apartemen mahasiswa.</li>
                                                                            <li>Menjaga keamanan asrama / rusunawa / apartemen mahasiswa bersama-sama dengan Pengurus;</li>
                                                                            <li>Menjaga ketertiban dan kenyamanan bersama dalam asrama / rusunawa / apartemen mahasiswa;</li>
                                                                            <li>Menjaga dan memelihara kebersihan dalam asrama / rusunawa / apartemen mahasiswa;</li>
                                                                            <li>Menjaga dan memelihara fasilitas dan peralatan asrama / rusunawa / apartemen mahasiswa;</li>
                                                                            <li>Mengikuti program kegiatan pembinaan yang dilakukan di asrama / rusunawa / apartemen mahasiswa baik rutin maupun insidental.</li>
                                                                            <li>Keluar dan masuk asrama / rusunawa / apartemen harus sepengetahuan Kepala asrama / rusunawa / apartemen;</li>
                                                                            <li>Menerima tamu di kamar tamu pada waktu yang telah ditentukan.</li>
                                                                            <li>Memelihara kerukunan beragama, bertoleransi, bekerjasama antar sesama penghuni.</li>
                                                                        </ol>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-footer text-muted">
                                                <div class="row">
                                                    <div class="col-md-11">
                                                        <label>
                                                            <input type="checkbox" name="checkb" class="agreecbox"> 
                                                            <span id="agreebox">
                                                                Saya memahami dan menyetujui semua persyaratan diatas.
                                                            </span>
                                                        </label>
                                                    </div>
                                                    <div class="col-md-1" id="infoAlert" style="display: none">
                                                        <i class="fa fa-info text-right text-danger" title="Anda harus menyetujuinya"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row" id="nextDiv" style="display: none">
                                    <div class="col-lg-12">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h4 class="text-center">Upload </h4>
                                                        <br>

                                                        <div class="form-group row">
                                                            <label for="inputEmail3" class="col-sm-3 col-form-label">Bukti SPP Terakhir</label>
                                                            <div class="col-sm-9">
                                                                <input type="file" name="filespp" required="" accept=".jpg,.png,.pdf">
                                                            </div>
                                                        </div>
                                                     <!--    <div class="form-group row">
                                                            <label for="inputEmail3" class="col-sm-3 col-form-label">Bukti Pembayaran Rusunawa</label>
                                                            <div class="col-sm-9">
                                                                <input type="file" name="filestruk" required="" accept=".jpg,.png,.pdf">
                                                            </div>
                                                        </div> -->
                                                        <input type="hidden" name="asrama_jenis" value="rusunawa">

                                                        <input type="hidden" name="ids" id="id"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-b" style="display: none" id="btnBack">Back</button>
                        <button type="button" class="btn btn-b" id="btnNext">Next</button>
                        <button type="submit" class="btn btn-b" style="display: none" id="btnFinish">Finish</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
<?php } ?>





<div class="modal fade" id="mdApart" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-md">
        <form action="<?= base_url('frontend/asrama/apartemen/booking_kamar')?>" method="POST" enctype="multipart/form-data">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="modal-label">Detail Kamar</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                </div>
                <div class="modal-body">
                    <div class="row team-members team-members-shadow m-b-40">
                        <div class="col-lg-12" id="newpend">

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-b" type="button">Close</button>
                </div>
            </div>
        </form>
    </div>
</div>




<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script> -->
<script type="text/javascript">
    $(document).ready(function() {

        let dataArr = <?= $ar; ?>;
        let gid; 
        var mySVG = document.getElementById("alphasvg");
        var svgDoc;
        mySVG.addEventListener("load",function() {

            svgDoc = mySVG.contentDocument.documentElement;

            var xd = svgDoc.getElementsByTagName("rect");
            var xy = svgDoc.getElementsByTagName("tspan");
            var lantai = xy.asrama_lantai;
            var tipe = xy.asrama_nama;
            var attrTipe = $('#svgfile object').attr('tipe');
            tipe.textContent = attrTipe ? attrTipe : 'RUSUNAWA LAMA PUTRA';
            var attrLantai = $('#svgfile object').attr('lantai');
            lantai.textContent = attrLantai ? attrLantai : '1';
            resetState(xd, dataArr, 'inisiasi');

        }, false);

        $('#btn_update').on('click', function(){
            var xd = svgDoc.getElementsByTagName("rect");
            var xy = svgDoc.getElementsByTagName("tspan");
            var lantai = xy.asrama_lantai;
            var tipe = xy.asrama_nama;
            resetState(xd, dataArr, 'reset');
            var gdgtyp = $("input[name='gdgtype']:checked").val();
            var lantaiid=$('#lantaiid').val();
            $.ajax({
                type: "POST",
                url: "<?= base_url('ajxsrusun');?>",
                data: { gdgtyp: gdgtyp, lantaiid: lantaiid}, 
                cache: false,
                success: function(result) {
                    var jres = JSON.parse(result);
                    lantai.textContent = jres.lantaix;
                    tipe.textContent = jres.tipex;
                    dataArr = jres.alldata
                    if(jres.isstatus == 'success'){


                      var content = {};
                      content.message = 'Berhasil merubah data';
                      content.title = 'success';
                      content.icon = 'fas fa-check';

                      var notify = $.notify(content, {
                        spacing: 10,
                        mouse_over: true,
                        type: 'success',
                        allow_dismiss: true,
                        timer: 2000,
                        newest_on_top: true,
                        showProgressbar: false,
                        placement: {
                            from: 'top',
                            align: 'right'
                        },
                        template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-success" role="alert">' +
                        '<button type="button" aria-hidden="true" class="close" data-notify="dismiss"><i class="icon-x"></i></button>' +
                        '<span data-notify="icon"></span> ' +
                        '<span data-notify="title">{1}</span> ' +
                        '<span data-notify="message">{2}</span>' +
                        '<div class="progress" data-notify="progressbar">' +
                        '</div>',
                        offset: {
                            x: 30,
                            y: 30
                        },
                        delay: 1000,
                        z_index: 10000,
                        animate: {
                            enter: 'animated ' + 'fadeInDown',
                            exit: 'animated ' + 'fadeOutDown'
                        }

                    });
                  }
                  $('#svgfile object').attr('data', '<?= base_url()?>assets/svgrender/'+jres.svgfile);
                  $('#svgfile object').attr('tipe', jres.tipex);
                  $('#svgfile object').attr('lantai', jres.lantaix);
                  bar_prog('#progtersedia',jres.tersedia);
                  bar_prog('#progbooking',jres.booking);
                  bar_prog('#progrusak',jres.rusak);
                  bar_prog('#progterisi',jres.terisi);


                  resetState(xd, dataArr, 'success_call');
              }
          });
        });
        function bar_prog(name, val){
            $(name +' .progress-number').text(val);
            $(name).data('data-percent',val);
            $(name).attr('style','width : ' + val+'%');  
        }

        function resetState(p_arg1, p_arg2, type){
            xd = p_arg1;
            dataArr = p_arg2;
            for(i=0;i<xd.length;i++){
                let get_a = xd[i].getAttribute('id');
                let gid,
                glantai,
                gstatus_asrama,
                gstatus_kamar,
                gpenghuni_kpm,
                gpa_tgl_masuk,
                gpa_tgl_booking,
                gpenghuni_nama,
                gpenghuni_foto,
                gpenghuni_prodi,
                gpenghuni_fakultas,
                gidval,
                jgedung,
                gstatus_txt,
                jnkmar;

                for (var a = 0; a < dataArr.length; a++) {
                    if (dataArr[a].idval == get_a) {
                        gid = dataArr[a].id;
                        jgedung = '';
                        jnkmar = gid.substring(3, 5);

                        glantai = dataArr[a].lantai;
                        gidval = dataArr[a].idval;
                        gstatus_asrama = dataArr[a].status_asrama;
                        gpenghuni_kpm = dataArr[a].penghuni_kpm;
                        gpenghuni_nama = dataArr[a].penghuni_nama;
                        gpenghuni_foto = dataArr[a].penghuni_foto;
                        gpenghuni_prodi = dataArr[a].penghuni_prodi;
                        gpenghuni_fakultas = dataArr[a].penghuni_fakultas;
                        gstatus_kamar = dataArr[a].status_kamar;
                        gstatus_txt = '-';

                        if(gid.substring(0, 2) == 'BA'){
                            jgedung = 'Rusunawa Putra';
                        } else if(gid.substring(0, 2) == 'BB'){
                            jgedung = 'Rusunawa Putri';
                        } else if(gid.substring(0, 2) == 'BC'){
                            jgedung = 'Rusunawa Baru Putri';
                        } else {
                            jgedung == '';
                        }
                        if(type == 'reset'){
                            xd[i].style.fill="#ffffff";
                            break;
                        } else {
                            if(gstatus_asrama=='rusak'){
                                xd[i].style.fill="#4e4e4e";
                                gstatus_txt = 'Sedang dalam Perbaikan';
                            } else if(gstatus_asrama=='isi'){
                                xd[i].style.fill="#d04c47";
                            } else if(gstatus_asrama=='tersedia'){
                                xd[i].style.fill="#ffffff";
                                gstatus_txt = 'Kosong';
                            }  else {
                                xd[i].style.fill="#ffffff";
                            }
                        }


                        xd[i].addEventListener("click", function(e){
                            e.preventDefault();
                            $("#mdApart").modal();
                            if(gpenghuni_kpm == null || gpenghuni_kpm == ''){
                                $("#newpend" ).html(`
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Jenis</label>
                                    <div class="col-sm-9">
                                    <span>`+jgedung+`</span>
                                    </div>
                                    </div>
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Lantai</label>
                                    <div class="col-sm-9">
                                    <span>`+glantai+`</span>
                                    </div>
                                    </div>
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Nomor Kamar</label>
                                    <div class="col-sm-9">
                                    <span>`+jnkmar+`</span>
                                    </div>
                                    </div>
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Status Kamar</label>
                                    <div class="col-sm-9">
                                    <span>`+gstatus_txt+`</span>
                                    </div>
                                    </div>
                                    </div>`);
                            } else {
                                $("#newpend" ).html(`
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Jenis</label>
                                    <div class="col-sm-9">
                                    <span>`+jgedung+`</span>
                                    </div>
                                    </div>
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Lantai</label>
                                    <div class="col-sm-9">
                                    <span>`+glantai+`</span>
                                    </div>
                                    </div>
                                    <div class="form-group row">
                                    <label for="inputEmail3" class="col-sm-3 col-form-label">Nomor Kamar</label>
                                    <div class="col-sm-9">
                                    <span>`+jnkmar+`</span>
                                    </div>
                                    </div>
                                    <hr>
                                    <div class="team-member">
                                    <div class="team-image">
                                    <img src="<?= base_url(); ?>uploads/user/`+gpenghuni_foto+`" style="max-width:350px;max-height350px;">
                                    </div>
                                    <div class="team-desc">
                                    <h3>`+gpenghuni_nama+`</h3>
                                    <span>`+gpenghuni_kpm+`</span>
                                    <p>(`+gpenghuni_fakultas +` / `+gpenghuni_prodi+`)</p>
                                    </div>
                                    </div>`);
                            }

                        });
                    }
                }
                xd[i].addEventListener("mouseover", function(callback){
                    callback.target.style.opacity="0.5"
                });

                xd[i].addEventListener("mouseleave", function(callback){
                    callback.target.style.opacity="1"
                });

            }
        }

        $('#btnNext').on('click', function() {
            let check_elem = $('.agreecbox');
            if(check_elem.prop("checked")){
                $('#nextDiv').show();
                $('#myDIV').hide();
                $("#btnBack").show();
                $("#btnNext").hide()
                $('#btnFinish').show();
            } else {
                $("#agreebox").addClass('text-danger');
                $('#infoAlert').show();
            }
        });
        $('#btnBack').on('click', function() {
            $('#myDIV').show();
            $('#nextDiv').hide();
            $("#btnBack").hide();
            $("#btnNext").show()
            $('#btnFinish').hide();
            $("#agreebox").removeClass('text-danger');
            $('#infoAlert').hide();
        });
    });

</script>



<script src="<?= base_url()?>assets/frontend/js/plugins.js"></script>

